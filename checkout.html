<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - U Miss My Fashion</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #fff; color: #000; margin: 0; padding-bottom: 100px; }
        .checkout-container { max-width: 800px; margin: 60px auto; padding: 0 20px; text-align: center; }
        
        .step-section { margin-bottom: 80px; }
        .step-num { font-size: 100px; font-weight: bold; margin: 0; line-height: 1; }
        .step-title { font-size: 32px; font-weight: bold; margin: 10px 0 40px 0; }

        /* Step 1: Billing Form */
        .billing-form { text-align: left; max-width: 600px; margin: 0 auto; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
        .form-group { display: flex; flex-direction: column; margin-bottom: 15px; }
        .form-group label { font-size: 14px; font-weight: bold; margin-bottom: 8px; }
        .form-group input, .form-group textarea { padding: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 15px; outline: none; }

        /* Step 2: Order Review with +/- Buttons (‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
        .order-review-box { 
            background: #fff; border: 1px solid #eee; border-radius: 8px; 
            padding: 25px; text-align: left; max-width: 650px; margin: 0 auto; 
        }
        .item-list-row { display: flex; align-items: center; gap: 15px; padding: 20px 0; border-bottom: 1px solid #f5f5f5; }
        .item-list-row img { width: 70px; height: 85px; object-fit: cover; border-radius: 4px; }
        .item-details { flex: 1; }
        .item-details h4 { margin: 0; font-size: 16px; font-weight: bold; }
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡∏£‡∏π‡∏õ */
        .qty-wrapper { display: flex; align-items: center; border: 1px solid #ddd; border-radius: 4px; width: fit-content; margin-top: 8px; }
        .qty-btn { background: none; border: none; padding: 5px 12px; cursor: pointer; font-size: 16px; font-weight: bold; }
        .qty-num { padding: 0 12px; font-size: 14px; border-left: 1px solid #ddd; border-right: 1px solid #ddd; min-width: 25px; text-align: center; }
        
        .item-price-end { font-weight: bold; font-size: 16px; min-width: 80px; text-align: right; }

        .summary-details { margin-top: 25px; }
        .summary-line { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 15px; color: #444; }
        .grand-total-line { 
            display: flex; justify-content: space-between; margin-top: 15px; 
            padding-top: 15px; border-top: 2px solid #000; font-size: 22px; font-weight: bold; 
        }

        /* Step 3: Payment */
        .payment-box { background: #f9f9f9; padding: 40px; border-radius: 8px; border: 1px solid #eee; max-width: 500px; margin: 0 auto; }
        .btn-confirm { 
            width: 100%; background: #333; color: #fff; border: none; padding: 18px; 
            font-size: 18px; font-weight: bold; border-radius: 4px; cursor: pointer; transition: 0.3s; 
        }
        .btn-confirm:hover { background: #000; }
    </style>
</head>
<body>

    <div class="checkout-container">
        <div class="step-section">
            <p class="step-num">1.</p>
            <h2 class="step-title">Billing details</h2>
            <div class="billing-form">
                <div class="form-row">
                    <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á *</label><input type="text" id="fname"></div>
                    <div class="form-group"><label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label><input type="text" id="lname"></div>
                </div>
                <div class="form-group"><label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á *</label><textarea id="address" rows="3"></textarea></div>
                <div class="form-row">
                    <div class="form-group"><label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î *</label><input type="text" id="province"></div>
                    <div class="form-group"><label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå *</label><input type="text" id="zipcode"></div>
                </div>
                <div class="form-group"><label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label><input type="tel" id="phone"></div>
            </div>
        </div>

        <div class="step-section">
            <p class="step-num">2.</p>
            <h2 class="step-title">Check Your Order</h2>
            <div class="order-review-box" id="checkout-container">
                </div>
        </div>

        <div class="step-section">
            <p class="step-num">3.</p>
            <h2 class="step-title">Payment Information</h2>
            <div class="payment-box">
                <p><b>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</b></p>
                <p style="font-size: 13px; color: #666; margin-bottom: 25px;"></p>
                <button onclick="window.location.href='payment.html'" class="btn-gb-pay">
    CONTINUE TO PAYMENT
</button>
            </div>
        </div>
    </div>

    <script>
        function renderCheckout() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const container = document.getElementById('checkout-container');
            
            if (cart.length === 0) {
                container.innerHTML = "<p style='text-align:center;'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</p>";
                return;
            }

            let subtotal = 0;
            let itemsHtml = '';

            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                itemsHtml += `
                    <div class="item-list-row">
                        <img src="${item.image}">
                        <div class="item-details">
                            <h4>${item.name} (${item.size})</h4>
                            <div class="qty-wrapper">
                                <button class="qty-btn" onclick="updateQty(${index}, -1)">-</button>
                                <span class="qty-num">${item.quantity}</span>
                                <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
                            </div>
                        </div>
                        <div class="item-price-end">‡∏ø${itemTotal.toLocaleString()}</div>
                    </div>
                `;
            });

            const shipping = 70;
            container.innerHTML = `
                ${itemsHtml}
                <div class="summary-details">
                    <div class="summary-line"><span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span><span>‡∏ø${subtotal.toLocaleString()}</span></div>
                    <div class="summary-line"><span>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á (EMS)</span><span>‡∏ø${shipping}</span></div>
                    <div class="grand-total-line"><span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</span><span>‡∏ø${(subtotal + shipping).toLocaleString()}</span></div>
                </div>
            `;
        }

        function updateQty(index, change) {
            let cart = JSON.parse(localStorage.getItem('cart'));
            cart[index].quantity += change;
            if (cart[index].quantity < 1) {
                if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
                    cart.splice(index, 1);
                } else {
                    cart[index].quantity = 1;
                }
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCheckout(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        }

        function sendOrder() {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ LINE ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            const fname = document.getElementById('fname').value;
            const address = document.getElementById('address').value;
            const phone = document.getElementById('phone').value;

            if(!fname || !address || !phone) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }

            const cart = JSON.parse(localStorage.getItem('cart'));
            let itemsText = "";
            let total = 70;

            cart.forEach((item, i) => {
                itemsText += `${i+1}. ${item.name} (${item.size}) x${item.quantity}\n`;
                total += (item.price * item.quantity);
            });

            let msg = `üìå *‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà*\nüë§ ‡∏Ñ‡∏∏‡∏ì: ${fname}\nüìû ‡πÇ‡∏ó‡∏£: ${phone}\nüè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${address}\n--------------------------\nüì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:\n${itemsText}--------------------------\nüí∞ ‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ‡∏ø${total.toLocaleString()}`;
            window.open(`https://line.me/ti/p/@umissmyfashion?text=${encodeURIComponent(msg)}`, '_blank');
        }

        document.addEventListener('DOMContentLoaded', renderCheckout);


        //‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡∏°‡πà//
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
function proceedToPayment() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    if (cart.length === 0) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
        return;
    }

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á (‡∏ï‡∏≤‡∏° Step 1)
    const fname = document.getElementById('fname').value;
    const phone = document.getElementById('phone').value;
    
    if (!fname || !phone) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
        // ‡∏™‡∏Å„É≠„Éº„É´‡πÑ‡∏õ‡∏ó‡∏µ‡πà Step 1 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å
        document.querySelector('.step-section').scrollIntoView({ behavior: 'smooth' });
        return;
    }

    // ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà payment.html
    window.location.href = 'payment.html';
}
    </script>
</body>
</html>
