<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตะกร้าสินค้า - U Miss My Fashion</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary-color: #000; --accent-color: #b08d57; --bg-gray: #f8f8f8; }
        body { background-color: #fff; margin: 0; font-family: 'Sarabun', sans-serif; }
        
        /* Navigation */
        nav ul { list-style: none; display: flex; gap: 20px; align-items: center; margin: 0; padding: 0; }
        nav ul li a { color: #fff !important; font-weight: bold; text-decoration: none; font-size: 18px; transition: 0.3s; position: relative; }
        nav ul li a:hover { color: #ffca85 !important; }
        #cart-count { background: #ff4d4d; color: white; border-radius: 50%; padding: 2px 6px; font-size: 10px; position: absolute; top: -10px; right: -7px; border: 2px solid #000; }

        /* Main Layout */
        .cart-container { max-width: 1200px; margin: 40px auto; padding: 0 20px; display: grid; grid-template-columns: 1fr 350px; gap: 30px; }
        @media (max-width: 992px) { .cart-container { grid-template-columns: 1fr; } }

        .cart-title { grid-column: 1 / -1; font-size: 24px; font-weight: bold; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 10px; }

        /* Product Table Style */
        .cart-table-header { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr auto; padding: 15px 0; border-bottom: 1px solid #eee; font-weight: bold; color: #888; font-size: 14px; }
        .cart-item { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr auto; align-items: center; padding: 20px 0; border-bottom: 1px solid #eee; }
        
        .product-info { display: flex; gap: 15px; align-items: center; }
        .product-info img { width: 70px; height: 90px; object-fit: cover; border-radius: 4px; }
        .product-details h4 { margin: 0; font-size: 15px; }
        .product-details p { margin: 5px 0 0; color: #888; font-size: 13px; }

        .qty-control { display: flex; align-items: center; border: 1px solid #ddd; width: fit-content; border-radius: 4px; }
        .qty-btn { background: none; border: none; padding: 5px 10px; cursor: pointer; font-size: 16px; }
        .qty-val { padding: 0 10px; font-size: 14px; min-width: 20px; text-align: center; }
        
        .price, .subtotal { font-weight: bold; font-size: 15px; }
        .remove-item { color: #ccc; cursor: pointer; transition: 0.3s; padding: 10px; }
        .remove-item:hover { color: #ff4d4d; }

        /* Summary Sidebar */
        .summary-card { background: var(--bg-gray); padding: 25px; border-radius: 8px; height: fit-content; position: sticky; top: 20px; }
        .summary-card h3 { margin-top: 0; font-size: 18px; border-bottom: 1px solid #ddd; padding-bottom: 15px; }
        .summary-row { display: flex; justify-content: space-between; margin: 15px 0; font-size: 14px; }
        .summary-total { display: flex; justify-content: space-between; margin: 20px 0; font-size: 18px; font-weight: bold; border-top: 1px solid #ddd; padding-top: 15px; }
        
        .btn-checkout { width: 100%; background: #555; color: #fff; border: none; padding: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; transition: 0.3s; font-size: 16px; margin-top: 10px; }
        .btn-checkout:hover { background: #000; }

        .empty-state { text-align: center; grid-column: 1 / -1; padding: 100px 0; }
        .empty-state i { font-size: 50px; color: #eee; margin-bottom: 20px; }
    </style>
</head>
<body>

    <header>
        <h1>UMissMyFashion</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="products.html">All Product</a></li> 
                <li><a href="shirt.html">Streetwear</a></li> 
                <li><a href="jeans.html">Jeans</a></li> 
                <li><a href="Luxury.html">Luxury</a></li> 
                <li>
                    <a href="cart.html">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span id="cart-count">0</span>
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <div class="cart-container" id="cart-container">
        <div class="cart-title">Shopping Cart</div>
        
        <div class="cart-list">
            <div class="cart-table-header">
                <span>สินค้า</span>
                <span>ราคา</span>
                <span>จำนวน</span>
                <span>ยอดรวม</span>
                <span></span>
            </div>
            <div id="cart-items-wrapper">
                </div>
        </div>

        <div class="summary-card" id="summary-card">
            <h3>ยอดรวม</h3>
            <div class="summary-row">
                <span>ยอดรวม</span>
                <span id="subtotal-price">฿0</span>
            </div>
            <div class="summary-row">
                <span>การจัดส่ง</span>
                <span>EMS: ฿70</span>
            </div>
            <div class="summary-total">
                <span>รวม</span>
                <span id="grand-total">฿0</span>
            </div>
            <a href="checkout.html" class="btn-checkout" style="text-decoration: none; text-align: center; display: block;">ดำเนินการสั่งซื้อ</a>
        </div>
    </div>

    <div id="empty-view" class="empty-state" style="display:none;">
        <i class="fa-solid fa-cart-shopping"></i>
        <h3>ตะกร้าสินค้าของคุณว่างเปล่า</h3>
        <p>ไปเลือกชมสินค้าที่น่าสนใจของเราได้เลย</p>
        <br>
        <a href="products.html" class="btn-checkout" style="text-decoration:none; padding:10px 30px;">ไปที่ร้านค้า</a>
    </div>

    <script>
        function renderCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const wrapper = document.getElementById('cart-items-wrapper');
            const cartContainer = document.getElementById('cart-container');
            const emptyView = document.getElementById('empty-view');
            const cartCount = document.getElementById('cart-count');

            // อัปเดตตัวเลขแจ้งเตือน
            const totalQty = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalQty;
            cartCount.style.display = totalQty > 0 ? 'block' : 'none';

            if (cart.length === 0) {
                cartContainer.style.display = 'none';
                emptyView.style.display = 'block';
                return;
            }

            cartContainer.style.display = 'grid';
            emptyView.style.display = 'none';
            wrapper.innerHTML = '';

            let subtotal = 0;

            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                wrapper.innerHTML += `
                    <div class="cart-item">
                        <div class="product-info">
                            <img src="${item.image}">
                            <div class="product-details">
                                <h4>${item.name}</h4>
                                <p>Size: ${item.size}</p>
                            </div>
                        </div>
                        <div class="price">฿${item.price.toLocaleString()}</div>
                        <div class="qty-control">
                            <button class="qty-btn" onclick="updateQty(${index}, -1)">-</button>
                            <span class="qty-val">${item.quantity}</span>
                            <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
                        </div>
                        <div class="subtotal">฿${itemTotal.toLocaleString()}</div>
                        <div class="remove-item" onclick="removeItem(${index})"><i class="fa-solid fa-xmark"></i></div>
                    </div>
                `;
            });

            document.getElementById('subtotal-price').textContent = `฿${subtotal.toLocaleString()}`;
            document.getElementById('grand-total').textContent = `฿${(subtotal + 70).toLocaleString()}`;
        }

        function updateQty(index, change) {
            let cart = JSON.parse(localStorage.getItem('cart'));
            cart[index].quantity += change;
            if (cart[index].quantity < 1) cart[index].quantity = 1;
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
        }

        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem('cart'));
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
        }

        function sendToLine() {
            const cart = JSON.parse(localStorage.getItem('cart'));
            let text = "สวัสดีครับ ต้องการสั่งซื้อสินค้าดังนี้:\n\n";
            cart.forEach((item, i) => {
                text += `${i+1}. ${item.name} (${item.size})\n   จำนวน ${item.quantity} ชิ้น - ฿${(item.price * item.quantity).toLocaleString()}\n\n`;
            });
            text += `ยอดรวมค่าส่ง EMS: ${document.getElementById('grand-total').textContent}`;
            
            const lineUrl = `https://line.me/ti/p/@umissmyfashion?text=${encodeURIComponent(text)}`;
            window.open(lineUrl, '_blank');
        }

        document.addEventListener('DOMContentLoaded', renderCart);
    </script>
</body>
</html>
